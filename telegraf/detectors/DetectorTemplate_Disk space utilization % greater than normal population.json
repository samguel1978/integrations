[ {
  "marshallScope" : 1
}, {
  "sf_detectorTemplate" : "Disk space utilization % greater than normal population",
  "sf_description" : "Alerts if disk space usage was significantly greater than other hosts for the last 10 minutes",
  "sf_type" : "DetectorTemplate",
  "sf_sourceSelectors" : [ "disk.summary_utilization" ],
  "sf_detectorTemplateSourceId" : "Ce4RoGeAAAE",
  "sf_detectorTemplateSource" : "{\"sf_organizationID\":\"BuStxseAAAA\",\"sf_detector\":\"Disk space utilization % greater than normal population Detector\",\"sf_uiModel\":{\"currentUniqueKey\":19,\"chartType\":\"line\",\"chartMode\":\"graph\",\"chartconfig\":{\"disableThrottle\":true,\"range\":900000,\"yAxisConfigurations\":[{\"name\":\"yAxis0\",\"id\":\"yAxis0\",\"max\":null,\"min\":null,\"plotlines\":{\"high\":null,\"low\":null}}],\"maxDelay\":0},\"revisionNumber\":1,\"allPlots\":[{\"name\":\"disk.summary_utilization - Mean + 3 STDDEV\",\"type\":\"plot\",\"invisible\":true,\"transient\":false,\"dataManipulations\":[{\"fn\":{\"type\":\"MEAN_STDDEV\",\"options\":{\"stddevcount\":3}},\"direction\":{\"type\":\"aggregation\",\"options\":{\"aggregateGroupBy\":[],\"collapseGroups\":false,\"transformTimeRange\":null}},\"showMe\":false}],\"yAxisIndex\":0,\"queryItems\":[],\"metricDefinition\":{},\"seriesData\":{\"metric\":\"disk.summary_utilization\",\"regExStyle\":null},\"uniqueKey\":1,\"focusNext\":false,\"configuration\":{\"rollupPolicy\":null}},{\"name\":\"disk.summary_utilization - P50\",\"type\":\"plot\",\"invisible\":true,\"transient\":false,\"dataManipulations\":[{\"fn\":{\"type\":\"PERCENTILE\",\"options\":{\"percentile\":50}},\"direction\":{\"type\":\"aggregation\",\"options\":{\"aggregateGroupBy\":[],\"collapseGroups\":false,\"transformTimeRange\":null}},\"showMe\":false}],\"yAxisIndex\":0,\"queryItems\":[],\"metricDefinition\":{},\"seriesData\":{\"metric\":\"disk.summary_utilization\",\"regExStyle\":null},\"uniqueKey\":2,\"focusNext\":false,\"configuration\":{\"rollupPolicy\":null}},{\"name\":\"disk.summary_utilization\",\"type\":\"plot\",\"invisible\":false,\"transient\":false,\"dataManipulations\":[],\"yAxisIndex\":0,\"queryItems\":[],\"metricDefinition\":{},\"seriesData\":{\"metric\":\"disk.summary_utilization\",\"regExStyle\":null},\"uniqueKey\":7,\"focusNext\":false,\"configuration\":{\"rollupPolicy\":null}},{\"name\":\"G-B - Absolute Value - P50\",\"type\":\"ratio\",\"invisible\":true,\"transient\":false,\"dataManipulations\":[{\"fn\":{\"type\":\"ABS\",\"options\":{}},\"direction\":{\"type\":\"aggregation\",\"options\":{\"aggregateGroupBy\":[],\"collapseGroups\":false,\"transformTimeRange\":null}},\"showMe\":false},{\"fn\":{\"type\":\"PERCENTILE\",\"options\":{\"percentile\":50}},\"direction\":{\"type\":\"aggregation\",\"options\":{\"aggregateGroupBy\":[],\"collapseGroups\":false,\"transformTimeRange\":null}},\"showMe\":false}],\"yAxisIndex\":0,\"queryItems\":[],\"metricDefinition\":{},\"seriesData\":{},\"uniqueKey\":10,\"focusNext\":false,\"valid\":true,\"expressionText\":\"G-B\"},{\"name\":\"disk.summary_utilization - Count - Exclude x < 15 - Count\",\"type\":\"plot\",\"invisible\":true,\"transient\":false,\"dataManipulations\":[{\"fn\":{\"type\":\"COUNT\",\"options\":{}},\"direction\":{\"type\":\"aggregation\",\"options\":{\"aggregateGroupBy\":[],\"collapseGroups\":false,\"transformTimeRange\":null}},\"showMe\":false},{\"fn\":{\"type\":\"EXCLUDE\",\"options\":{\"mode\":\"below\",\"action\":\"drop\",\"low\":15}},\"direction\":{\"type\":\"aggregation\",\"options\":{\"aggregateGroupBy\":[],\"collapseGroups\":false,\"transformTimeRange\":null}},\"showMe\":false},{\"fn\":{\"type\":\"COUNT\",\"options\":{}},\"direction\":{\"type\":\"aggregation\",\"options\":{\"aggregateGroupBy\":[],\"collapseGroups\":false,\"transformTimeRange\":null}},\"showMe\":false}],\"yAxisIndex\":0,\"queryItems\":[],\"metricDefinition\":{},\"seriesData\":{\"metric\":\"disk.summary_utilization\",\"regExStyle\":null},\"uniqueKey\":11,\"focusNext\":false,\"configuration\":{\"rollupPolicy\":null}},{\"name\":\"B + 3* J\",\"type\":\"ratio\",\"invisible\":true,\"transient\":false,\"dataManipulations\":[],\"yAxisIndex\":0,\"queryItems\":[],\"metricDefinition\":{},\"seriesData\":{},\"uniqueKey\":13,\"focusNext\":false,\"valid\":true,\"expressionText\":\"B + 3* J\"},{\"name\":\"A-M - Absolute Value\",\"type\":\"ratio\",\"invisible\":true,\"transient\":false,\"dataManipulations\":[{\"fn\":{\"type\":\"ABS\",\"options\":{}},\"direction\":{\"type\":\"aggregation\",\"options\":{\"aggregateGroupBy\":[],\"collapseGroups\":false,\"transformTimeRange\":null}},\"showMe\":false}],\"yAxisIndex\":0,\"queryItems\":[],\"metricDefinition\":{},\"seriesData\":{},\"uniqueKey\":14,\"focusNext\":false,\"valid\":true,\"expressionText\":\"A-M\"},{\"name\":\"((2 - K)*M + K*A + K*N)/2\",\"type\":\"ratio\",\"invisible\":false,\"transient\":false,\"dataManipulations\":[],\"yAxisIndex\":1,\"queryItems\":[],\"metricDefinition\":{},\"seriesData\":{},\"uniqueKey\":15,\"focusNext\":false,\"valid\":true,\"expressionText\":\"((2 - K)*M + K*A + K*N)/2\"}],\"rules\":[{\"name\":\"One host has significantly higher disk space utilization than others\",\"uniqueKey\":17,\"jobResolution\":\"1 second\",\"duration\":\"10m\",\"severityLevel\":\"Major\",\"edit\":false,\"thresholdMode\":\"above\",\"triggerMode\":\"duration\",\"notifications\":[],\"invalid\":false,\"targetPlot\":\"G\",\"above\":\"O\",\"percentOfDuration\":100}],\"fromChart\":\"Ce0wIN2AAAA\",\"uiHelperValue\":\"Ce4RoGeAAAE_4\",\"selectedPlotId\":7},\"sf_jobMaxDelay\":0,\"sf_rules\":[{\"baseProgramText\":\"_SF_PLOT_KEY___OBJECT_ID___1_1=id(report=1);_SF_PLOT_KEY___OBJECT_ID___2_1=id(report=1);_SF_PLOT_KEY___OBJECT_ID___7_1=id(report=1);_SF_PLOT_KEY___OBJECT_ID___10_1=id(report=1);_SF_PLOT_KEY___OBJECT_ID___10_1_MACROBLOCK=[?G,?B,!OUT]{?G - ?B->!OUT};_SF_PLOT_KEY___OBJECT_ID___11_1=id(report=1);_SF_PLOT_KEY___OBJECT_ID___13_1=id(report=1);_SF_PLOT_KEY___OBJECT_ID___13_1_MACROBLOCK=[?B,?J,!OUT]{?B  +  3 *  ?J->!OUT};_SF_PLOT_KEY___OBJECT_ID___14_1=id(report=1);_SF_PLOT_KEY___OBJECT_ID___14_1_MACROBLOCK=[?A,?M,!OUT]{?A - ?M->!OUT};_SF_PLOT_KEY___OBJECT_ID___15_1=id(report=1);_SF_PLOT_KEY___OBJECT_ID___15_1_MACROBLOCK=[?K,?M,?A,?N,!OUT]{((2  -  ?K) * ?M  +  ?K * ?A  +  ?K * ?N) / 2->!OUT};find(query='(sf_metric:disk.summary_utilization AND _missing_:sf_programId)') -> fetch(extrapolation='NULL_EXTRAPOLATION',maxExtrapolations=-1) -> groupby() -> _SF_PLOT_KEY___OBJECT_ID___1_1_TEMP_VAR_0_INPUT=id;_SF_PLOT_KEY___OBJECT_ID___1_1_TEMP_VAR_0_INPUT->stats:!stddev->_SF_PLOT_KEY___OBJECT_ID___1_1_TEMP_VAR_0_STDDEV=id;_SF_PLOT_KEY___OBJECT_ID___1_1_TEMP_VAR_0_INPUT->stats:!mean->_SF_PLOT_KEY___OBJECT_ID___1_1_TEMP_VAR_0_MEAN=id;_SF_PLOT_KEY___OBJECT_ID___1_1_TEMP_VAR_0_SUM=math;_SF_PLOT_KEY___OBJECT_ID___1_1_TEMP_VAR_0_STDDEVPROD= math(b=3);_SF_PLOT_KEY___OBJECT_ID___1_1_TEMP_VAR_0_STDDEV->?a:_SF_PLOT_KEY___OBJECT_ID___1_1_TEMP_VAR_0_STDDEVPROD;_SF_PLOT_KEY___OBJECT_ID___1_1_TEMP_VAR_0_STDDEVPROD:!product->?a:_SF_PLOT_KEY___OBJECT_ID___1_1_TEMP_VAR_0_SUM;_SF_PLOT_KEY___OBJECT_ID___1_1_TEMP_VAR_0_MEAN->?b:_SF_PLOT_KEY___OBJECT_ID___1_1_TEMP_VAR_0_SUM;_SF_PLOT_KEY___OBJECT_ID___1_1_TEMP_VAR_0_SUM:!sum -> _SF_PLOT_KEY___OBJECT_ID___1_1;find(query='(sf_metric:disk.summary_utilization AND _missing_:sf_programId)') -> fetch(extrapolation='NULL_EXTRAPOLATION',maxExtrapolations=-1) -> groupby() -> stats:!p50 -> _SF_PLOT_KEY___OBJECT_ID___2_1;find(query='(sf_metric:disk.summary_utilization AND _missing_:sf_programId)') -> fetch(extrapolation='NULL_EXTRAPOLATION',maxExtrapolations=-1) -> split -> _SF_PLOT_KEY___OBJECT_ID___7_1;_SF_PLOT_KEY___OBJECT_ID___10_1_MACROBLOCK:!OUT->{ abs(?in) -> !out }->groupby()->stats:!p50->_SF_PLOT_KEY___OBJECT_ID___10_1->publish(metric='_SF_PLOT_KEY___OBJECT_ID___10_1',sf_uiAnalyticsDerivedMetric=1,sf_uiHelper='__OBJECT_ID___1');_SF_PLOT_KEY___OBJECT_ID___7_1->?G:_SF_PLOT_KEY___OBJECT_ID___10_1_MACROBLOCK;_SF_PLOT_KEY___OBJECT_ID___2_1->?B:_SF_PLOT_KEY___OBJECT_ID___10_1_MACROBLOCK;find(query='(sf_metric:disk.summary_utilization AND _missing_:sf_programId)') -> fetch(extrapolation='NULL_EXTRAPOLATION',maxExtrapolations=-1) -> groupby() -> stats:!count -> {if ( ?in >= 15 ) { ?in -> !out }} -> stats:!count -> _SF_PLOT_KEY___OBJECT_ID___11_1;_SF_PLOT_KEY___OBJECT_ID___13_1_MACROBLOCK:!OUT->_SF_PLOT_KEY___OBJECT_ID___13_1->publish(metric='_SF_PLOT_KEY___OBJECT_ID___13_1',sf_uiAnalyticsDerivedMetric=1,sf_uiHelper='__OBJECT_ID___1');_SF_PLOT_KEY___OBJECT_ID___2_1->?B:_SF_PLOT_KEY___OBJECT_ID___13_1_MACROBLOCK;_SF_PLOT_KEY___OBJECT_ID___10_1->?J:_SF_PLOT_KEY___OBJECT_ID___13_1_MACROBLOCK;_SF_PLOT_KEY___OBJECT_ID___14_1_MACROBLOCK:!OUT->{ abs(?in) -> !out }->_SF_PLOT_KEY___OBJECT_ID___14_1->publish(metric='_SF_PLOT_KEY___OBJECT_ID___14_1',sf_uiAnalyticsDerivedMetric=1,sf_uiHelper='__OBJECT_ID___1');_SF_PLOT_KEY___OBJECT_ID___1_1->?A:_SF_PLOT_KEY___OBJECT_ID___14_1_MACROBLOCK;_SF_PLOT_KEY___OBJECT_ID___13_1->?M:_SF_PLOT_KEY___OBJECT_ID___14_1_MACROBLOCK;_SF_PLOT_KEY___OBJECT_ID___15_1_MACROBLOCK:!OUT->_SF_PLOT_KEY___OBJECT_ID___15_1->publish(metric='_SF_PLOT_KEY___OBJECT_ID___15_1',sf_uiAnalyticsDerivedMetric=1,sf_uiHelper='__OBJECT_ID___1');_SF_PLOT_KEY___OBJECT_ID___11_1->?K:_SF_PLOT_KEY___OBJECT_ID___15_1_MACROBLOCK;_SF_PLOT_KEY___OBJECT_ID___13_1->?M:_SF_PLOT_KEY___OBJECT_ID___15_1_MACROBLOCK;_SF_PLOT_KEY___OBJECT_ID___1_1->?A:_SF_PLOT_KEY___OBJECT_ID___15_1_MACROBLOCK;_SF_PLOT_KEY___OBJECT_ID___14_1->?N:_SF_PLOT_KEY___OBJECT_ID___15_1_MACROBLOCK\",\"jobResolution\":1000,\"uniqueKey\":17,\"eventType\":\"_SF_PLOT_KEY___OBJECT_ID___17_1\",\"name\":\"One host has significantly higher disk space utilization than others\",\"readable\":\"\\\"disk.summary_utilization\\\" is above \\\"((2 - K)*M + K*A + K*N)/2\\\" for 2m\",\"severity\":\"Major\",\"notifications\":[]}],\"sf_programs\":[{\"programText\":\"_SF_PLOT_KEY_Ce4RoGeAAAE_1_6=id(report=1);_SF_PLOT_KEY_Ce4RoGeAAAE_2_6=id(report=1);_SF_PLOT_KEY_Ce4RoGeAAAE_7_6=id(report=1);_SF_PLOT_KEY_Ce4RoGeAAAE_10_6=id(report=1);_SF_PLOT_KEY_Ce4RoGeAAAE_10_6_MACROBLOCK=[?G,?B,!OUT]{?G - ?B->!OUT};_SF_PLOT_KEY_Ce4RoGeAAAE_11_6=id(report=1);_SF_PLOT_KEY_Ce4RoGeAAAE_13_6=id(report=1);_SF_PLOT_KEY_Ce4RoGeAAAE_13_6_MACROBLOCK=[?B,?J,!OUT]{?B  +  3 *  ?J->!OUT};_SF_PLOT_KEY_Ce4RoGeAAAE_14_6=id(report=1);_SF_PLOT_KEY_Ce4RoGeAAAE_14_6_MACROBLOCK=[?A,?M,!OUT]{?A - ?M->!OUT};_SF_PLOT_KEY_Ce4RoGeAAAE_15_6=id(report=1);_SF_PLOT_KEY_Ce4RoGeAAAE_15_6_MACROBLOCK=[?K,?M,?A,?N,!OUT]{((2  -  ?K) * ?M  +  ?K * ?A  +  ?K * ?N) / 2->!OUT};find(query='(sf_metric:disk.summary_utilization AND _missing_:sf_programId)') -> fetch(extrapolation='NULL_EXTRAPOLATION',maxExtrapolations=-1) -> groupby() -> _SF_PLOT_KEY_Ce4RoGeAAAE_1_6_TEMP_VAR_0_INPUT=id;_SF_PLOT_KEY_Ce4RoGeAAAE_1_6_TEMP_VAR_0_INPUT->stats:!stddev->_SF_PLOT_KEY_Ce4RoGeAAAE_1_6_TEMP_VAR_0_STDDEV=id;_SF_PLOT_KEY_Ce4RoGeAAAE_1_6_TEMP_VAR_0_INPUT->stats:!mean->_SF_PLOT_KEY_Ce4RoGeAAAE_1_6_TEMP_VAR_0_MEAN=id;_SF_PLOT_KEY_Ce4RoGeAAAE_1_6_TEMP_VAR_0_SUM=math;_SF_PLOT_KEY_Ce4RoGeAAAE_1_6_TEMP_VAR_0_STDDEVPROD= math(b=3);_SF_PLOT_KEY_Ce4RoGeAAAE_1_6_TEMP_VAR_0_STDDEV->?a:_SF_PLOT_KEY_Ce4RoGeAAAE_1_6_TEMP_VAR_0_STDDEVPROD;_SF_PLOT_KEY_Ce4RoGeAAAE_1_6_TEMP_VAR_0_STDDEVPROD:!product->?a:_SF_PLOT_KEY_Ce4RoGeAAAE_1_6_TEMP_VAR_0_SUM;_SF_PLOT_KEY_Ce4RoGeAAAE_1_6_TEMP_VAR_0_MEAN->?b:_SF_PLOT_KEY_Ce4RoGeAAAE_1_6_TEMP_VAR_0_SUM;_SF_PLOT_KEY_Ce4RoGeAAAE_1_6_TEMP_VAR_0_SUM:!sum -> _SF_PLOT_KEY_Ce4RoGeAAAE_1_6;find(query='(sf_metric:disk.summary_utilization AND _missing_:sf_programId)') -> fetch(extrapolation='NULL_EXTRAPOLATION',maxExtrapolations=-1) -> groupby() -> stats:!p50 -> _SF_PLOT_KEY_Ce4RoGeAAAE_2_6;find(query='(sf_metric:disk.summary_utilization AND _missing_:sf_programId)') -> fetch(extrapolation='NULL_EXTRAPOLATION',maxExtrapolations=-1) -> split -> _SF_PLOT_KEY_Ce4RoGeAAAE_7_6;_SF_PLOT_KEY_Ce4RoGeAAAE_10_6_MACROBLOCK:!OUT->{ abs(?in) -> !out }->groupby()->stats:!p50->_SF_PLOT_KEY_Ce4RoGeAAAE_10_6->publish(metric='_SF_PLOT_KEY_Ce4RoGeAAAE_10_6',sf_uiAnalyticsDerivedMetric=1,sf_uiHelper='Ce4RoGeAAAE_6');_SF_PLOT_KEY_Ce4RoGeAAAE_7_6->?G:_SF_PLOT_KEY_Ce4RoGeAAAE_10_6_MACROBLOCK;_SF_PLOT_KEY_Ce4RoGeAAAE_2_6->?B:_SF_PLOT_KEY_Ce4RoGeAAAE_10_6_MACROBLOCK;find(query='(sf_metric:disk.summary_utilization AND _missing_:sf_programId)') -> fetch(extrapolation='NULL_EXTRAPOLATION',maxExtrapolations=-1) -> groupby() -> stats:!count -> {if ( ?in >= 15 ) { ?in -> !out }} -> stats:!count -> _SF_PLOT_KEY_Ce4RoGeAAAE_11_6;_SF_PLOT_KEY_Ce4RoGeAAAE_13_6_MACROBLOCK:!OUT->_SF_PLOT_KEY_Ce4RoGeAAAE_13_6->publish(metric='_SF_PLOT_KEY_Ce4RoGeAAAE_13_6',sf_uiAnalyticsDerivedMetric=1,sf_uiHelper='Ce4RoGeAAAE_6');_SF_PLOT_KEY_Ce4RoGeAAAE_2_6->?B:_SF_PLOT_KEY_Ce4RoGeAAAE_13_6_MACROBLOCK;_SF_PLOT_KEY_Ce4RoGeAAAE_10_6->?J:_SF_PLOT_KEY_Ce4RoGeAAAE_13_6_MACROBLOCK;_SF_PLOT_KEY_Ce4RoGeAAAE_14_6_MACROBLOCK:!OUT->{ abs(?in) -> !out }->_SF_PLOT_KEY_Ce4RoGeAAAE_14_6->publish(metric='_SF_PLOT_KEY_Ce4RoGeAAAE_14_6',sf_uiAnalyticsDerivedMetric=1,sf_uiHelper='Ce4RoGeAAAE_6');_SF_PLOT_KEY_Ce4RoGeAAAE_1_6->?A:_SF_PLOT_KEY_Ce4RoGeAAAE_14_6_MACROBLOCK;_SF_PLOT_KEY_Ce4RoGeAAAE_13_6->?M:_SF_PLOT_KEY_Ce4RoGeAAAE_14_6_MACROBLOCK;_SF_PLOT_KEY_Ce4RoGeAAAE_15_6_MACROBLOCK:!OUT->_SF_PLOT_KEY_Ce4RoGeAAAE_15_6->publish(metric='_SF_PLOT_KEY_Ce4RoGeAAAE_15_6',sf_uiAnalyticsDerivedMetric=1,sf_uiHelper='Ce4RoGeAAAE_6');_SF_PLOT_KEY_Ce4RoGeAAAE_11_6->?K:_SF_PLOT_KEY_Ce4RoGeAAAE_15_6_MACROBLOCK;_SF_PLOT_KEY_Ce4RoGeAAAE_13_6->?M:_SF_PLOT_KEY_Ce4RoGeAAAE_15_6_MACROBLOCK;_SF_PLOT_KEY_Ce4RoGeAAAE_1_6->?A:_SF_PLOT_KEY_Ce4RoGeAAAE_15_6_MACROBLOCK;_SF_PLOT_KEY_Ce4RoGeAAAE_14_6->?N:_SF_PLOT_KEY_Ce4RoGeAAAE_15_6_MACROBLOCK;_SF_PLOT_KEY_Ce4RoGeAAAE_17_6=threshold(eventType='_SF_PLOT_KEY_Ce4RoGeAAAE_17_6', defaultSource='_SF_PLOT_KEY_Ce4RoGeAAAE_7_6', duration=120000, fractionOfDuration=1);_SF_PLOT_KEY_Ce4RoGeAAAE_7_6 -> _SF_PLOT_KEY_Ce4RoGeAAAE_17_6;_SF_PLOT_KEY_Ce4RoGeAAAE_15_6->?high:_SF_PLOT_KEY_Ce4RoGeAAAE_17_6\",\"jobResolution\":1000}]}",
  "sf_detectorParameters" : "{\"Rule_1_Notifications\":{\"name\":\"Rule_1_Notifications\",\"description\":\"\",\"uniqueKey\":17,\"type\":\"RuleNotifications\"},\"Plot_A_Filters\":{\"name\":\"Plot_A_Filters\",\"description\":\"\",\"uniqueKey\":1,\"type\":\"Filters\"},\"Plot_B_Filters\":{\"name\":\"Plot_B_Filters\",\"description\":\"\",\"uniqueKey\":2,\"type\":\"Filters\"},\"Plot_G_Filters\":{\"name\":\"Plot_G_Filters\",\"description\":\"\",\"uniqueKey\":7,\"type\":\"Filters\"},\"Plot_J_Filters\":{\"name\":\"Plot_J_Filters\",\"description\":\"\",\"uniqueKey\":10,\"type\":\"Filters\"},\"Plot_K_Filters\":{\"name\":\"Plot_K_Filters\",\"description\":\"\",\"uniqueKey\":11,\"type\":\"Filters\"},\"Plot_M_Filters\":{\"name\":\"Plot_M_Filters\",\"description\":\"\",\"uniqueKey\":13,\"type\":\"Filters\"},\"Plot_N_Filters\":{\"name\":\"Plot_N_Filters\",\"description\":\"\",\"uniqueKey\":14,\"type\":\"Filters\"},\"Plot_O_Filters\":{\"name\":\"Plot_O_Filters\",\"description\":\"\",\"uniqueKey\":15,\"type\":\"Filters\"}}",
  "marshallId" : 1
} ]
